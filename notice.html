<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>School Notices</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body class="bg-gray-100 text-gray-900 font-sans">

<!-- Header -->
<header class="bg-blue-700 text-white shadow-lg">
  <div class="container mx-auto flex justify-between items-center p-4">
    <h1 class="text-2xl font-bold">School Notices</h1>
    <nav>
      <a href="index.html" class="px-3 hover:underline">Home</a>
      <a href="quiz.html" class="px-3 hover:underline">Quizzes</a>
      <a href="chat.html" class="px-3 hover:underline">Chat</a>
    </nav>
  </div>
</header>

<!-- Page Title -->
<section class="bg-blue-100 py-6 text-center">
  <h2 class="text-3xl font-bold text-blue-800">Latest Announcements</h2>
</section>

<!-- Notice List -->
<main class="container mx-auto p-4">
  <div id="notice-list" class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
    <!-- Notices will load here dynamically -->
  </div>
</main>

<!-- Admin Add Notice -->
<section class="container mx-auto mt-6 p-6 bg-white shadow-lg rounded-lg max-w-xl">
  <h3 class="text-xl font-semibold mb-4">Add New Notice</h3>
  <form id="notice-form" class="space-y-4">
    <input type="text" id="notice-title" placeholder="Notice Title" class="w-full p-2 border rounded" required>
    <textarea id="notice-content" placeholder="Notice Details" class="w-full p-2 border rounded" required></textarea>
    <button type="submit" class="bg-blue-700 text-white py-2 px-4 rounded hover:bg-blue-800">Post Notice</button>
  </form>
</section>

<!-- Firebase Script -->
<script>
  // ✅ Your Firebase Config
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    projectId: "YOUR_PROJECT",
    storageBucket: "YOUR_PROJECT.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const noticeList = document.getElementById('notice-list');
  const form = document.getElementById('notice-form');

  // ✅ Fetch Notices
  db.collection('notices').orderBy('timestamp', 'desc').onSnapshot(snapshot => {
    noticeList.innerHTML = '';
    snapshot.forEach(doc => {
      const notice = doc.data();
      noticeList.innerHTML += `
        <div class="bg-white shadow p-4 rounded">
          <h4 class="font-bold text-lg">${notice.title}</h4>
          <p class="text-gray-700">${notice.content}</p>
          <button onclick="deleteNotice('${doc.id}')" class="mt-3 bg-red-600 text-white py-1 px-3 rounded">Delete</button>
        </div>
      `;
    });
  });

  // ✅ Add Notice
  form.addEventListener('submit', e => {
    e.preventDefault();
    const title = document.getElementById('notice-title').value;
    const content = document.getElementById('notice-content').value;
    db.collection('notices').add({
      title,
      content,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    }).then(() => {
      form.reset();
    });
  });

  // ✅ Delete Notice
  function deleteNotice(id) {
    db.collection('notices').doc(id).delete();
  }
</script>

</body>
</html>
